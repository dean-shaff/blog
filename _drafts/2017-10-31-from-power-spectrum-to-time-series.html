---
layout: post
title: From Power Spectrum to Time Series
date: '2017-10-31T22:49:00.002-07:00'
author: dshaff001
tags: 
modified_time: '2017-10-31T22:49:32.801-07:00'
blogger_id: tag:blogger.com,1999:blog-8551793629529973046.post-9025655947543308025
blogger_orig_url: http://deanshaff.blogspot.com/2017/10/from-power-spectrum-to-time-series.html
---

<div dir="ltr" style="text-align: left;" trbidi="on">In the radio astronomy work I do, much of the data I interact with are spectra. A power spectrum shows power as a function of frequency. Power spectra are useful for two reasons: One, the integral of the power spectrum is equal to the total energy of the signal we originally receive. See <a href="https://en.wikipedia.org/wiki/Parseval%27s_theorem">Parseval's theorem</a> Two, the power spectrum shows spectral line emission information. These spectral lines contain information about the chemical constituents of the sources we look. It has been quite a while since I've formally studied how emission works, but in short, chemicals get energetically excited and emit radiation as a means of dissipating that energy. The emitted radiation is specific to the electron transitions happening in the molecule, so spectral lines can be used to identify which molecules are present in a source. Power spectra can also illuminate interesting physics happening at the source. For instance, we can infer the presence of rotating material in a source, by looking at small red and blue shifts of a particular line. This is particularly meaningful if a source cannot be resolved (it appears as a point source); we are gaining information about the physics of material in the source without being able to take a detailed picture.<br /><br />I usually spend much of my time <i>looking </i>at power spectra. Once a particular dataset is calibrated, it is pretty clear whether particular spectra lines are present or not; they appear as narrow bumps in the power spectrum at an expected frequency. Sometime this summer, I asked myself whether or not we could <i>listen</i> for these frequency domain bumps. Translating from the frequency domain to the time domain is pretty easy, as illustrated with this little snippet of Python/Numpy code:<br /><br />```python<br />mag = np.absolute(array)<br />min_phase, max_phase = -np.pi, np.pi<br />phase = np.random.uniform(min_phase, max_phase, size=array.shape[1])phase_tiled = np.tile(phase, (array.shape[0],1))<br />FFT = mag * np.exp(1j*phase_tiled)<br />iFFT = np.fft.ifft(FFT, axis=1)<br />time_series = iFFT.flatten()<br />``` <br /><br /></div>